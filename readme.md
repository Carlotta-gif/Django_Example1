“”作业”
#作业完成过程
##主要步骤
#<1>首先使用github创建一个新的仓库Django_Example1（这个仓库地址应该设置为公开的，并且置于我的Carlotta-gif下）
#<2>创立公私钥对
#<3>将 ~/.ssh/id_rsa.pub文件的内容复制到git服务器的ssh 秘钥中
#<4>git clone 我的仓库地址，然后本地的电脑上出现一个和仓库名字一样的目录
#<5>cd仓库名目录，也就是cd mysite，开始后面的编码工作
#<6>编码过程中：
a.使用python manage.py makemigration, python manage.py migrate两行代码来进行迁移，并且使用python manage.py runserver来检查是否能正常运行
b.增加.gitignore文件写入两行：
**.sqlite3
**.pyc
将所有不需要提交到仓库的sqlite3文件和pyc文件过滤掉(在add操作时自动忽略掉)
c.使用git add .,git commit -m "增加一个新的Django工程/增加一个文件上传的功能", git push 这几行代码把新增加的工程文件加入本地仓库/提交/推送到远程仓库
#<7>django管理页面的打开和创建
使用代码$python manage.py createsuperuser创建一个能登陆管理页面的用户
接着使用命令$python manage.py runserver启动开发服务器，然后打开浏览器，转到本地域名的/admin/目录，就可以看到管理员登陆界面，设置完Username和Password之后就进入管理站点页面

##遇到的问题和解决的方法
#<1>找不到文件：把旧的文件删了，新建一个目录，然后把新的文件加进去
#<2>显示没有路径path
有的是要把git之类的加入环境变量，有的就是在浏览器中换一个访问路径
#<3>显示 no such file or directory,需要检查是否save了文件

#有关代码
#asgi.py中输入
"""
ASGI config for mysite project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/3.1/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'mysite.settings')

application = get_asgi_application()
#settings.py中
"""
Django settings for mysite project.

Generated by 'django-admin startproject' using Django 3.1.2.

For more information on this file, see
https://docs.djangoproject.com/en/3.1/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/3.1/ref/settings/
"""

from pathlib import Path

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/3.1/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = '(a--c=qux41k6p90at#4koqv_7cddqhws#si)i#4jfv3*wu%+h'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'news',
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'mysite.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'mysite.wsgi.application'


# Database
# https://docs.djangoproject.com/en/3.1/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}


# Password validation
# https://docs.djangoproject.com/en/3.1/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/3.1/topics/i18n/

LANGUAGE_CODE = 'en-us'

TIME_ZONE = 'UTC'

USE_I18N = True

USE_L10N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/3.1/howto/static-files/

STATIC_URL = '/static/'
#urls.py中
from django.contrib import admin
from django.urls import path,include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('news/', include('news.urls')),
]
#urls.py中输入
from django.contrib import admin
from django.urls import path,include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('news/', include('news.urls')),
]
#wsgi.py中输入
"""
WSGI config for mysite project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/3.1/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'mysite.settings')

application = get_wsgi_application()
#新建news目录，并且下设_pycache_,migrations,templates,polls等子目录以及admin.py,apps.py,models.py,tests.py,urls.py和views.py等文件
#admin.py中输入
from django.contrib import admin

from . import models

admin.site.register(models.Student)
#admin.site.register(models.Article)
#admin.site.register(models.Reporter)

#apps.py中输入
from django.apps import AppConfig


class NewsConfig(AppConfig):
    name = 'news'

#models.py中输入
from django.db import models

class Student(models.Model):
    full_name = models.CharField(max_length=70)
    #age = models.IntegerField()
    class Sex(models.IntegerChoices):
        MALE = 1, '男'
        FEMALE = 2, '女'
        OTHER = 3, '其他'

    sex = models.IntegerField(choices=Sex.choices)

    def __str__(self):
        return self.full_name

class Homework(models.Model):
    commit_date = models.DateField(auto_now=True)
    headline = models.CharField(max_length=200)
    attach = models.FileField()
    remark = models.TextField()
    student = models.ForeignKey(Student, on_delete=models.CASCADE)

    def __str__(self):
        return self.headline
#urls.py中输入
from django.urls import path

from . import views

urlpatterns = [
    path('hw/create/', views.HomeworkCreate.as_view()),
    #path('articles/<int:year>/', views.year_archive),
    #path('articles/<int:year>/<int:month>/',views.month_archive),
    #path('articles/<int:year>/<int:month>/<int:pk>/', views.article_detail),
]
#views.py中输入
from .models import Student, Homework

from django.views.generic.edit import CreateView

class HomeworkCreate(CreateView):
    model = Homework
    template_name = 'homework_form.html'
    fields = ['headline','attach','remark', 'student']
